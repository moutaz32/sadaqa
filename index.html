<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="صدقة جارية على روح المغفور له بإذن الله المهندس الحاج محمد المملوك ابن خديجة.">
    <meta name="theme-color" content="#1e293b">
    <title>نور | م. محمد المملوك</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;500;700;900&family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        :root { --primary: #059669; --dark: #0f172a; --light: #f8fafc; --accent: #fbbf24; --glass: rgba(255, 255, 255, 0.98); --shadow: 0 4px 20px rgba(0,0,0,0.08); }
        [data-theme="dark"] { --primary: #34d399; --dark: #020617; --light: #111827; --glass: rgba(30, 41, 59, 0.98); --text: #f1f5f9; }
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Tajawal', sans-serif; background: var(--light); color: [data-theme="dark"] ? #fff : #333; transition: 0.3s; padding-bottom: 120px; background-image: radial-gradient(var(--primary) 0.5px, transparent 0.5px); background-size: 20px 20px; }
        
        header { background: linear-gradient(160deg, #064e3b, #065f46); color: white; padding: 50px 20px 80px; text-align: center; border-radius: 0 0 50px 50px; position: relative; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .theme-btn { position: absolute; top: 20px; left: 20px; background: rgba(255,255,255,0.2); border: none; color: white; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; }
        
        .intro-text { font-size: 0.9rem; opacity: 0.9; margin-bottom: 5px; }
        .title-text { font-size: 1.3rem; color: #fbbf24; font-weight: bold; margin-bottom: 5px; }
        .deceased-name { font-size: 2rem; font-weight: 900; color: white; text-shadow: 0 2px 10px rgba(0,0,0,0.3); line-height: 1.3; }
        
        .container { max-width: 600px; margin: -50px auto 0; padding: 0 15px; position: relative; z-index: 10; }
        .card { background: var(--glass); border-radius: 20px; padding: 20px; margin-bottom: 15px; box-shadow: var(--shadow); border-top: 4px solid var(--primary); }
        [data-theme="dark"] .card { background: #1e293b; color: white; border: none; border-top: 4px solid var(--primary); }
        .card h2 { font-size: 1.2rem; margin-bottom: 15px; color: var(--primary); display: flex; align-items: center; gap: 10px; }

        /* تنسيق كروت النخلة والصك */
        .special-card { border-top: 4px solid var(--accent) !important; box-shadow: 0 10px 25px rgba(251, 191, 36, 0.15); text-align: center; }
        .media-box { width: 100%; border-radius: 15px; margin-bottom: 15px; border: 2px solid rgba(0,0,0,0.05); }
        .date-badge { display: inline-block; background: var(--primary); color: white; padding: 5px 15px; border-radius: 20px; font-size: 0.85rem; margin-bottom: 15px; }
        .family-dedication { background: rgba(5, 150, 105, 0.1); padding: 15px; border-radius: 10px; margin-bottom: 15px; border: 1px dashed var(--primary); }
        [data-theme="dark"] .family-dedication { background: rgba(251, 191, 36, 0.1); border-color: var(--accent); }

        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .action-btn { background: rgba(0,0,0,0.03); padding: 15px; border-radius: 12px; text-align: center; cursor: pointer; font-weight: bold; color: inherit; display: flex; flex-direction: column; align-items: center; gap: 5px; font-size: 0.95rem; }
        [data-theme="dark"] .action-btn { background: rgba(255,255,255,0.05); }
        .action-btn i { font-size: 1.5rem; color: var(--primary); }
        
        .gift-btn { width: 100%; padding: 15px; background: var(--accent); color: #1e293b; border: none; border-radius: 15px; font-weight: bold; font-size: 1.1rem; cursor: pointer; display: flex; justify-content: center; gap: 10px; }
        
        .sebha-circle { width: 150px; height: 150px; background: var(--light); border-radius: 50%; margin: 10px auto; display: flex; flex-direction: column; justify-content: center; align-items: center; border: 5px solid var(--accent); cursor: pointer; }
        [data-theme="dark"] .sebha-circle { background: rgba(255,255,255,0.05); }
        .counter { font-size: 3.5rem; font-weight: 800; color: var(--primary); }

        .share-card { background: #1e293b; color: white; padding: 25px; border-radius: 15px; text-align: center; border: 2px solid var(--accent); margin-bottom: 15px; }

        .floating-player { position: fixed; bottom: 0; left: 0; width: 100%; background: var(--glass); backdrop-filter: blur(10px); padding: 12px 20px; border-top: 1px solid rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: space-between; z-index: 100; box-shadow: 0 -5px 20px rgba(0,0,0,0.1); }
        [data-theme="dark"] .floating-player { background: #1e293b; color: white; }
        .play-toggle { width: 45px; height: 45px; background: var(--primary); color: white; border-radius: 50%; border: none; cursor: pointer; display: grid; place-items: center; font-size: 1.2rem; }

        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 2000; padding: 10px; overflow-y: auto; justify-content: center; align-items: flex-start; }
        .modal.active { display: flex; }
        .modal-content { background: #fff; width: 100%; max-width: 600px; border-radius: 20px; padding: 20px; margin-top: 20px; position: relative; min-height: 50vh; }
        [data-theme="dark"] .modal-content { background: #1e293b; color: white; }
        .close-modal { position: sticky; top: 0; left: 0; background: #ef4444; color: white; width: 35px; height: 35px; border-radius: 50%; display: grid; place-items: center; cursor: pointer; float: left; margin-bottom: 10px; z-index: 5; }
        
        .quran-text { font-family: 'Amiri', serif; font-size: 1.5rem; line-height: 2.6; text-align: center; white-space: pre-wrap; padding-bottom: 30px; }
        .basmala { font-family: 'Amiri', serif; color: var(--primary); font-size: 1.5rem; margin-bottom: 20px; display: block; }
        .loader { text-align: center; font-weight: bold; color: var(--primary); padding: 20px; }
        .azkar-item { border-bottom: 1px solid rgba(0,0,0,0.1); padding: 15px 0; font-size: 1.2rem; text-align: right; }
        .badge { background: var(--accent); color: #1e293b; padding: 2px 10px; border-radius: 10px; font-size: 0.8rem; float: left; }
    </style>
</head>
<body>

    <header>
        <button class="theme-btn" onclick="toggleTheme()"><i class="fas fa-moon"></i></button>
        <div class="intro-text">صدقة جارية على روح المغفور له بإذن الله</div>
        <div class="title-text">المهندس الحاج</div>
        <div class="deceased-name">محمد المملوك ابن خديجة</div>
        <p style="font-size:0.9rem; margin-top:10px; opacity:0.9;">اللهم اجعل قبره روضة من رياض الجنة</p>
    </header>

    <div class="container">

        <!-- 1. وثيقة الصدقة (الصك باسم العائلة) -->
        <div class="card special-card">
            <h2 style="justify-content: center; color: var(--accent); font-size: 1.4rem;">
                <i class="fas fa-certificate"></i> وثيقة الصدقة الجارية
            </h2>
            
            <div class="family-dedication">
                <p style="font-size: 1rem; line-height: 1.8; font-weight: bold;">
                    هذا العمل الصالح مُقدم بفضل الله من:<br>
                    <span style="color: var(--primary); font-size: 1.2rem;">الزوجة المخلصة، وجميع أبنائه وبناته</span><br>
                    براً ووفاءً وحباً لروح والدهم الغالي.
                </p>
            </div>

            <!-- صورة الصك -->
            <img src="sak.jpg" alt="صك النخيل" class="media-box" onerror="this.style.display='none'">
        </div>

        <!-- 2. النخلة والفيديو -->
        <div class="card special-card">
            <h2 style="justify-content: center; color: var(--primary); font-size: 1.3rem;">
                <i class="fas fa-tree"></i> لحظة غرس النخلة
            </h2>
            <div class="date-badge"><i class="fas fa-calendar-alt"></i> غرة رمضان (19 فبراير 2026)</div>
            
            <!-- صورة النخلة -->
            <img src="tree.jpg" alt="نخلة الحاج محمد المملوك" class="media-box" onerror="this.style.display='none'">
            
            <!-- فيديو النخلة -->
            <video class="media-box" controls preload="metadata" style="background: #000;">
                <source src="video.mp4" type="video/mp4">
                متصفحك لا يدعم تشغيل الفيديو.
            </video>
        </div>

        <!-- 3. هدية الفاتحة -->
        <div class="card">
            <h2><i class="fas fa-gift" style="color:var(--accent)"></i> هدية لروحه</h2>
            <button class="gift-btn" id="fatihaBtn" onclick="giftFatiha()">
                <i class="fas fa-heart"></i> أهديت له الفاتحة
            </button>
        </div>

        <!-- 4. السور المنجية -->
        <div class="card">
            <h2><i class="fas fa-book-open"></i> السور المنجية (قراءة كاملة)</h2>
            <div class="grid-2">
                <div class="action-btn" onclick="fetchSurah(36, 'سورة يس')"><i class="fas fa-heart" style="color:#ef4444"></i> يس</div>
                <div class="action-btn" onclick="fetchSurah(67, 'سورة الملك')"><i class="fas fa-shield-alt" style="color:#3b82f6"></i> الملك</div>
                <div class="action-btn" onclick="fetchSurah(56, 'سورة الواقعة')"><i class="fas fa-leaf" style="color:#22c55e"></i> الواقعة</div>
                <div class="action-btn" onclick="fetchSurah(18, 'سورة الكهف')"><i class="fas fa-lightbulb" style="color:#eab308"></i> الكهف</div>
            </div>
            <a href="https://quran.com/ar" target="_blank" class="action-btn" style="width:100%; margin-top:10px; background:var(--primary); color:white; border:none; display:block; text-decoration:none;">
                <i class="fas fa-book" style="color:white;"></i> تصفح المصحف كاملاً
            </a>
        </div>

        <!-- 5. الأذكار -->
        <div class="card">
            <h2><i class="fas fa-hands-praying"></i> حصن المسلم</h2>
            <div class="grid-2">
                <div class="action-btn" onclick="openAzkar('morning')"><i class="fas fa-sun" style="color:#f59e0b"></i> الصباح</div>
                <div class="action-btn" onclick="openAzkar('evening')"><i class="fas fa-moon" style="color:#6366f1"></i> المساء</div>
                <div class="action-btn" onclick="openAzkar('sleep')"><i class="fas fa-bed" style="color:#8b5cf6"></i> النوم</div>
                <div class="action-btn" onclick="openAzkar('dead')"><i class="fas fa-praying-hands" style="color:#ef4444"></i> للمتوفي</div>
            </div>
        </div>

        <!-- 6. السبحة -->
        <div class="card">
            <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                <h2><i class="fas fa-fingerprint"></i> السبحة</h2>
                <button onclick="resetSebha()" style="background:none; border:none; color:#ef4444; font-weight:bold;">تصفير</button>
            </div>
            <div class="sebha-circle" onclick="countSebha()">
                <span class="counter" id="counter">0</span>
                <span style="font-size:0.8rem; opacity:0.7">اضغط</span>
            </div>
            <div id="zekrName" style="text-align:center; font-weight:bold; color:var(--primary); margin:10px 0;">سبحان الله وبحمده</div>
            <div style="display:flex; justify-content:center; gap:5px;">
                <button onclick="setZekr('أستغفر الله')" style="padding:5px; border-radius:5px; border:1px solid #ddd; background:transparent; color:inherit;">أستغفر الله</button>
                <button onclick="setZekr('الحمد لله')" style="padding:5px; border-radius:5px; border:1px solid #ddd; background:transparent; color:inherit;">الحمد لله</button>
                <button onclick="setZekr('لا حول ولا قوة إلا بالله')" style="padding:5px; border-radius:5px; border:1px solid #ddd; background:transparent; color:inherit;">الحوقلة</button>
            </div>
        </div>

        <!-- 7. كارت الدعاء -->
        <div class="card">
            <h2><i class="fas fa-image"></i> شارك دعاء (صورة)</h2>
            <div class="share-card" id="cardCapture">
                <div style="font-family:'Amiri'; font-size:1.5rem; color:#f59e0b; margin-bottom:5px;">بسم الله الرحمن الرحيم</div>
                <p style="font-size:1.1rem; line-height:1.8;">
                    "اللهم اغفر لعبدك<br>
                    <span style="color:#f59e0b; font-weight:bold; font-size:1.4rem;">المهندس الحاج<br>محمد المملوك بن خديجة</span><br>
                    وآنس وحشته وارحم غربته<br>واجعل قبره روضة من رياض الجنة"
                </p>
                <div style="margin-top:15px; font-size:0.8rem; opacity:0.7;">صدقة جارية مقدمة من أسرته</div>
            </div>
            <button class="action-btn" style="width:100%; background:var(--accent); color:#1e293b;" onclick="downloadImage()">
                <i class="fas fa-download"></i> تحميل الصورة
            </button>
        </div>

    </div>

    <!-- المشغل العائم -->
    <div class="floating-player">
        <div style="display:flex; align-items:center; gap:10px;">
            <div style="width:10px; height:10px; background:red; border-radius:50%; animation:blink 1s infinite;"></div>
            <span style="font-weight:bold; color:var(--primary); font-size:0.9rem;">إذاعة القرآن الكريم</span>
        </div>
        <button class="play-toggle" onclick="toggleRadio()"><i class="fas fa-play" id="playIcon"></i></button>
        <audio id="radio" src="https://n0e.radiojar.com/8s5u5tpdtwzuv?rj-ttl=5&rj-tok=AAABjF_2tEIA2Bw1g4l5qf7mQw"></audio>
    </div>

    <!-- نافذة المحتوى -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="close-modal" onclick="closeModal()">&times;</div>
            <h2 id="modalTitle" style="text-align:center; color:var(--primary); margin-bottom:15px;"></h2>
            <div id="modalBody" class="quran-text"></div>
        </div>
    </div>

    <script>
        async function fetchSurah(number, title) {
            document.getElementById('modalTitle').innerText = title;
            document.getElementById('modalBody').innerHTML = '<div class="loader">جارِ تحميل السورة كاملة...</div>';
            document.getElementById('modal').classList.add('active');
            try {
                const response = await fetch(`https://api.alquran.cloud/v1/surah/${number}`);
                const data = await response.json();
                let fullText = number !== 9 ? `<span class="basmala">بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ</span>` : "";
                data.data.ayahs.forEach(ayah => {
                    let text = ayah.text;
                    if(number !== 1 && number !== 9) text = text.replace("بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ", "");
                    fullText += `${text} <span class="ayah-number">(${ayah.numberInSurah})</span> `;
                });
                document.getElementById('modalBody').innerHTML = fullText;
            } catch (error) {
                document.getElementById('modalBody').innerHTML = `تأكد من الاتصال بالإنترنت`;
            }
        }

        const azkarDB = {
            'morning': `<div class="azkar-item">"اللهم بك أصبحنا وبك أمسينا" <span class="badge">1</span></div><div class="azkar-item">"سبحان الله وبحمده" <span class="badge">100</span></div>`,
            'evening': `<div class="azkar-item">"أمسينا وأمسى الملك لله" <span class="badge">1</span></div><div class="azkar-item">"أعوذ بكلمات الله التامات من شر ما خلق" <span class="badge">3</span></div>`,
            'sleep': `<div class="azkar-item">"باسمك اللهم أموت وأحيا"</div><div class="azkar-item">آية الكرسي</div>`,
            'dead': `<div class="azkar-item">"اللهم اغفر له وارحمه، وعافه واعف عنه"</div><div class="azkar-item">"اللهم اجعل قبره روضة من رياض الجنة"</div>`
        };

        function openAzkar(type) {
            const titles = {'morning': 'أذكار الصباح', 'evening': 'أذكار المساء', 'sleep': 'أذكار النوم', 'dead': 'دعاء للمتوفي'};
            document.getElementById('modalTitle').innerText = titles[type];
            document.getElementById('modalBody').innerHTML = azkarDB[type];
            document.getElementById('modal').classList.add('active');
        }
        function closeModal() { document.getElementById('modal').classList.remove('active'); }

        let count = localStorage.getItem('sebha_count') || 0;
        document.getElementById('counter').innerText = count;
        function countSebha() {
            count++; document.getElementById('counter').innerText = count;
            localStorage.setItem('sebha_count', count);
            if(navigator.vibrate) navigator.vibrate(10);
        }
        function resetSebha() { if(confirm("تصفير العداد؟")) { count=0; document.getElementById('counter').innerText=0; localStorage.setItem('sebha_count',0); } }
        function setZekr(txt) { document.getElementById('zekrName').innerText = txt; }

        const radio = document.getElementById('radio');
        const icon = document.getElementById('playIcon');
        function toggleRadio() {
            if(radio.paused) { radio.play(); icon.className="fas fa-pause"; }
            else { radio.pause(); icon.className="fas fa-play"; }
        }

        function toggleTheme() {
            const body = document.body;
            body.setAttribute('data-theme', body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark');
        }

        function giftFatiha() {
            const btn = document.getElementById('fatihaBtn');
            btn.innerHTML = '<i class="fas fa-check"></i> تقبل الله منك';
            btn.style.background = "#059669";
            btn.style.color = "white";
            if(navigator.vibrate) navigator.vibrate(50);
        }
        function downloadImage() {
            html2canvas(document.getElementById("cardCapture"), {backgroundColor: "#1e293b"}).then(canvas => {
                const link = document.createElement('a');
                link.download = 'Dua_Haj_Mohamed.png';
                link.href = canvas.toDataURL();
                link.click();
            });
        }
    </script>
</body>
</html>


